{% extends "templates/layout.html" %}
{% block javascript %}
	<script type="text/javascript" src="/js/invoice_edit.js"></script>
{% endblock %}

{% block css %}
	<link rel="stylesheet" type="text/css" href="/css/invoice.css"/>
{% endblock %}

{% block title %}
	{% i18n "invoice-edit-title" %}
{% endblock %}

{% block template %}
	<script type="text/html" id="confirm-remove-invoice-template">{% i18n "invoice_remove_confirm" %}</script>
	
	<script type="text/html" id="delete-template">{% i18n "delete" %}</script>
	
	<script type="text/html" id="invoice-line-editable-template">
		<td class="id-field"><input type="text" name="id-field[]" value="{{"{{"}}id{{"}}"}}"/></td>
		<td><input type="text" class="description-field kernely_input" name="designation-field[]" value="{{"{{"}}description{{"}}"}}"/></td>
		<td><input type="text" class="quantity-field kernely_input" name="quantity-field[]" value="{{"{{"}}quantity{{"}}"}}"/></td>
		<td><input type="text" class="unitprice-field kernely_input" name="unitprice-field[]" value="{{"{{"}}unitprice{{"}}"}}"/></td>
		<td class="line-amount">{{"{{"}}amount{{"}}"}}</td>
		<td class="vat-column"></td>
		<td class="delete-column"><img src="/images/icons/delete_icon.png" class="delete-invoice-line"/></td>
	</script>

{% endblock %}

{% block content %}
	<form action="/invoice/update/{{invoice.id}}" method="POST" id="invoice-edition">
		
		<span id="invoice-visu-i" style="display:none;">{{invoice.id}}</span>
		<!-- Invoice button bar -->
		<div id="invoicing-buttons-bar">
			<input type="button" class="button_emphasis" id="delete-invoice" value="{% i18n "delete" %}"/>
		</div>
		<!-- Invoice header -->
		<div id="invoice-header">
			<h2><span>{% i18n "invoice" %}</span> {{invoice.organizationName}}</h2>
		</div>
		<!-- General informations -->
		<div id="invoice-general-informations">
			<table id="invoice-general-informations-table">
				<tr><td class="label-column">{% i18n "invoice-code" %}</td><td><input type="text" class="general-informations-fields kernely_input" name="invoice-code" value="{{invoice.code}}"/></td></tr>
				<tr><td class="label-column">{% i18n "invoice-publication" %}</td><td><input type="text" class="general-informations-fields kernely_input" id="invoice-publication" name="invoice-sending" value="{{invoice.datePublicationString}}"/></td></tr>
				<tr><td class="label-column">{% i18n "invoice-term" %}</td><td><input type="text" class="general-informations-fields kernely_input" id="invoice-term" name="invoice-term" value="{{invoice.dateTermString}}"/></td>
					<td><input type="text" class="general-informations-fields kernely_input" name="invoice-devise kernely_input" value="&euro;"/></td></tr>
				<tr><td class="label-column">{% i18n "invoice-object" %}</td><td colspan="2"><input type="text" class="general-informations-fields object-field kernely_input" name="invoice-object" value="{{invoice.object}}"/></td></tr>
			</table>
		</div>
		<!-- Invoice details -->
		<br/>
		<div id="invoice-details">
			<div id="invoice-details-new-button-bar">
				<input type="button" class="button_emphasis" id="new-invoice-line" value="{% i18n "invoice-new-line" %}"/>
			</div>
			<table id="invoice-line-details" class="kernely_table">
				<thead>
					<tr>
						<th class="id-field"><!--id of the line--></th>
						<th class="description-column">{% i18n "invoice-line-description" %}</th>
						<th class="quantity-column">{% i18n "invoice-line-quantity" %}</th>
						<th class="unitprice-column">{% i18n "invoice-line-unit-price" %}</th>
						<th class="amount-column">{% i18n "invoice-line-amount" %}</th>
						<th class="vat-column">{% i18n "invoice-line-vat" %}</th>
						<th class="delete-column"><!-- Column for the delete button --></th>
					</tr>
				</thead>
				<tbody id="invoice-lines">
				</tbody>
			</table>
		</div>
		
		<div class="subtitle">{% i18n "invoice-comment" %}</div>
		<textarea id="invoice-comment" name="invoice-comment">{{invoice.comment}}</textarea>
		
		<!-- Footer button bar -->
		<div id="invoice-button-bar">
			<input type="button" id="export-invoice"  class="button_emphasis" value="{% i18n "export" %}"/>
			<input type="button" id="cancel-invoice" class="button_standard" value="{% i18n "cancel" %}" onClick="window.location = '/invoice/{{invoice.id}}/view';"/>
			<input type="submit" id="validate-invoice" class="button_ok" value="{% i18n "ok" %}"/>
		</div>
	</form>
{% endblock %}